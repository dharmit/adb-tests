- job:
    name: adb-vagrantfile-tests
    node: atomic-sig
    properties:
        - github:
            url: https://github.com/projectatomic/adb-atomic-developer-bundle
    publishers:
        - email:
            recipients: dshah@redhat.com
        - github-notifier
    builders:
        - inject:
            properties-content: |
                API_KEY=3ee4ec22-0abe-11e5-b2e3-525400ea212d
                MACHINE_COUNT=1
                GIT_REPO_URL='https://github.com/dharmit/adb-tests.git'
                ANSIBLE_REPO_URL='https://github.com/dharmit/adb-ci-ansible'
        - centos-ci-bootstrap
    scm:
        - custom-scm
    triggers:
        - custom-trigger

- builder:
    name: centos-ci-bootstrap
    builders:
        - python:
            !include-raw: './run.py'

- trigger:
    name: custom-trigger
    triggers:
        - github-pull-request:
            admin-list:
                - dharmit
                - LalatenduMohanty
                - navidshaikh
                - praveenkumar
            trigger-phrase: '#build'
            permit-all: false
            github-hooks: true
            started-status: "Executing tests on CentOS CI"
            success-status: "Successfully tested"
            failure-status: "Tests failed :("
# GitHub repo info
- scm:
    name: custom-scm
    scm:
        - git:
            git-tool: ci-git
            url: https://github.com/projectatomic/adb-atomic-developer-bundle
            wipe-workspace: false
            refspec: +refs/pull/*:refs/remotes/origin/pr/*
            skip-tag: true
            branches:
                - ${sha1}
